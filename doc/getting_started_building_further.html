<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Building Further</title>
<link rel="stylesheet" href="../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="../index.html" title="QUINCE: QUeries IN C++ Expressions">
<link rel="up" href="../getting_started.html" title="Chapter&#160;3.&#160;Getting Started">
<link rel="prev" href="buliding_a_query.html" title="Buliding a Query">
<link rel="next" href="ceci_n_est_pas_une_pipe.html" title="Ceci n'est pas une pipe">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="spirit-nav">
<a accesskey="p" href="buliding_a_query.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../getting_started.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="ceci_n_est_pas_une_pipe.html"><img src="../images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="getting_started.building_further"></a><a class="link" href="building_further.html" title="Building Further">Building Further</a>
</h2></div></div></div>
<pre class="programlisting">
    <span class="keyword">const</span> <span class="identifier">query</span><span class="special">&lt;</span><span class="identifier">screen</span><span class="special">&gt;</span> <span class="identifier">local_screens</span> <span class="special">=</span>
        <span class="identifier">local_cinemas</span>
        <span class="special">.</span><span class="identifier">jump</span><span class="special">(</span><span class="identifier">screens</span><span class="special">,</span> <span class="identifier">screens</span><span class="special">-&gt;</span><span class="identifier">cinema_id</span> <span class="special">==</span> <span class="identifier">local_cinemas</span><span class="special">-&gt;</span><span class="identifier">id</span><span class="special">);</span>
</pre>
<h4>
<a name="getting_started.building_further.h0"></a>
          <span class="phrase"><a name="getting_started.building_further.remarks"></a></span><a class="link" href="building_further.html#getting_started.building_further.remarks">Remarks</a>
        </h4>
<p>
          This statement builds on the query <code class="computeroutput"><span class="identifier">local_cinemas</span></code>,
          in much the same way that the previous statement built on the table <code class="computeroutput"><span class="identifier">cinemas</span></code>.
        </p>
<p>
          The effect of <code class="computeroutput"><span class="identifier">jump</span><span class="special">()</span></code>
          can be understood as follows: imagine we took the output of <code class="computeroutput"><span class="identifier">local_cinemas</span></code>, and replaced each <code class="computeroutput"><span class="identifier">cinema</span></code> <em class="replaceable"><code>c</code></em> by
          all the records in <code class="computeroutput"><span class="identifier">screens</span></code>
          whose <code class="computeroutput"><span class="identifier">cinema_id</span></code> matches
          <em class="replaceable"><code>c</code></em>'s <code class="computeroutput"><span class="identifier">id</span></code>.
          That would give us the output of the query we just built. All those records
          are of type <code class="computeroutput"><span class="identifier">screen</span></code>, so
          the new query is a <code class="computeroutput"><span class="identifier">query</span><span class="special">&lt;</span><span class="identifier">screen</span><span class="special">&gt;</span></code>.
        </p>
<p>
          Notice that this operation would work just as well if <code class="computeroutput"><span class="identifier">local_cinemas</span></code>
          were replaced by some other query with the same output as <code class="computeroutput"><span class="identifier">local_cinemas</span></code>, or even by a simple table
          that contained all the records that <code class="computeroutput"><span class="identifier">local_cinemas</span></code>
          produces. And that is generally the way: when I build upon one query to
          make another, I try not to depend on any details of how the first query
          was built. That makes the code easy to refactor later.
        </p>
<p>
          We learnt in the previous section that <code class="computeroutput"><span class="identifier">local_cinemas</span></code>'s
          value mapper is identical to <code class="computeroutput"><span class="identifier">cinemas</span></code>'s
          value mapper. So I could have written <code class="computeroutput"><span class="identifier">cinemas</span><span class="special">-&gt;</span></code><em class="replaceable"><code>...</code></em> instead
          of <code class="computeroutput"><span class="identifier">local_cinemas</span><span class="special">-&gt;</span></code><em class="replaceable"><code>...</code></em>.
          It would have worked the same, and it would have saved six keystrokes,
          but I went the other way. Why? To avoid dependence on the detail of how
          <code class="computeroutput"><span class="identifier">local_cinemas</span></code> was made.
          If some future round of refactoring eliminates the <code class="computeroutput"><span class="identifier">cinemas</span></code>
          table, and builds <code class="computeroutput"><span class="identifier">local_cinemas</span></code>
          in some different way, the code here will still compile and run.
        </p>
<p>
          I'm expressing a stylistic preference, no more, and it may not be very
          important -- except insofar is it helps to explain code examples in this
          document that would be puzzling if you didn't know.
        </p>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2014 Michael Shepanski<p>
        Distributed under the Boost Software License, Version 1.0
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="buliding_a_query.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../getting_started.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="ceci_n_est_pas_une_pipe.html"><img src="../images/next.png" alt="Next"></a>
</div>
</body>
</html>
