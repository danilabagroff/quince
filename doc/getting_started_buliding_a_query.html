<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Buliding a Query</title>
<link rel="stylesheet" href="../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="../index.html" title="QUINCE: QUeries IN C++ Expressions">
<link rel="up" href="../getting_started.html" title="Chapter&#160;3.&#160;Getting Started">
<link rel="prev" href="building_expressions_for_server_.html" title="Building Expressions for Server-Side Evaluation">
<link rel="next" href="building_further.html" title="Building Further">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="spirit-nav">
<a accesskey="p" href="building_expressions_for_server_.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../getting_started.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="building_further.html"><img src="../images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="getting_started.buliding_a_query"></a><a class="link" href="buliding_a_query.html" title="Buliding a Query">Buliding a Query</a>
</h2></div></div></div>
<pre class="programlisting">
    <span class="keyword">const</span> <span class="identifier">query</span><span class="special">&lt;</span><span class="identifier">cinema</span><span class="special">&gt;</span> <span class="identifier">local_cinemas</span> <span class="special">=</span>
        <span class="identifier">cinemas</span>
        <span class="special">.</span><span class="identifier">where</span><span class="special">(</span><span class="identifier">within_radius</span><span class="special">);</span>
</pre>
<h4>
<a name="getting_started.buliding_a_query.h0"></a>
          <span class="phrase"><a name="getting_started.buliding_a_query.remarks"></a></span><a class="link" href="buliding_a_query.html#getting_started.buliding_a_query.remarks">Remarks</a>
        </h4>
<p>
          <code class="computeroutput"><span class="identifier">local_cinemas</span></code> is a query
          that filters the records in <code class="computeroutput"><span class="identifier">cinemas</span></code>
          by the predicate <code class="computeroutput"><span class="identifier">within_radius</span></code>.
          Its output is all the records in <code class="computeroutput"><span class="identifier">cinemas</span></code>
          for which the predicate <code class="computeroutput"><span class="identifier">within_radius</span></code>
          evaluates to true.
        </p>
<p>
          Here are two things to know about queries:
        </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
              They have a value type (like <code class="computeroutput"><span class="identifier">table</span></code>s
              do), and it is a template parameter to the <code class="computeroutput"><span class="identifier">query</span></code>
              class; e.g. <code class="computeroutput"><span class="identifier">query</span><span class="special">&lt;</span><span class="identifier">cinema</span><span class="special">&gt;</span></code>
              has the value type <code class="computeroutput"><span class="identifier">cinema</span></code>.
            </li>
<li class="listitem">
              They have a value mapper (like <code class="computeroutput"><span class="identifier">table</span></code>s
              do), and their <code class="computeroutput"><span class="keyword">operator</span><span class="special">-&gt;()</span></code> returns a pointer to it, just
              as a <code class="computeroutput"><span class="identifier">table</span></code>'s <code class="computeroutput"><span class="keyword">operator</span><span class="special">-&gt;()</span></code>
              does.
            </li>
</ul></div>
<p>
          In the case of <code class="computeroutput"><span class="identifier">local_cinemas</span></code>,
          its value mapper is identical to <code class="computeroutput"><span class="identifier">cinemas</span></code>'s
          value mapper, in the strictest sense of <span class="quote">&#8220;<span class="quote">identical</span>&#8221;</span>: <code class="computeroutput"><span class="identifier">cinemas</span><span class="special">.</span><span class="keyword">operator</span><span class="special">-&gt;()</span>
          <span class="special">==</span> <span class="identifier">local_cinemas</span><span class="special">.</span><span class="keyword">operator</span><span class="special">-&gt;()</span></code>. That is because <code class="computeroutput"><span class="identifier">local_cinemas</span></code>
          was created by <code class="computeroutput"><span class="identifier">where</span><span class="special">()</span></code>,
          which has the following rules:
        </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
              <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">where</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>'s value type is identical to <em class="replaceable"><code>Q</code></em>'s.
            </li>
<li class="listitem">
              <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">where</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>'s value mapper is identical to <em class="replaceable"><code>Q</code></em>'s.
            </li>
</ul></div>
<p>
          (which, by the way, are also true of <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">distinct</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>,
          <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">distinct_on</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>, <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">except</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>,
          <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">except_all</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>, <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">intersect</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>,
          <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">intersect_all</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>, <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">limit</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>,
          <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">order</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>, <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">skip</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>,
          <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">union_</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>, and <em class="replaceable"><code>Q</code></em><code class="computeroutput"><span class="special">.</span><span class="identifier">union_all</span><span class="special">(</span></code>...<code class="computeroutput"><span class="special">)</span></code>.
          On the other hand there are somewhat different rules for <code class="computeroutput"><span class="identifier">select</span><span class="special">()</span></code>
          and functions in the <code class="computeroutput"><span class="identifier">join</span><span class="special">()</span></code> family.)
        </p>
<p>
          And here are two more things to know about queries (and tables also):
        </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
              They have a copy constructor, but not a default constructor or assignment.
            </li>
<li class="listitem">
              When you build on one to make another (as we built on <code class="computeroutput"><span class="identifier">cinemas</span></code> to make <code class="computeroutput"><span class="identifier">local_cinemas</span></code>),
              the first one is unchanged, and still usable, e.g. you could build
              on it again to make yet another query.
            </li>
</ul></div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2014 Michael Shepanski<p>
        Distributed under the Boost Software License, Version 1.0
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="building_expressions_for_server_.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../getting_started.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="building_further.html"><img src="../images/next.png" alt="Next"></a>
</div>
</body>
</html>
