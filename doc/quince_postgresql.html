<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Chapter&#160;12.&#160;quince_postgresql</title>
<link rel="stylesheet" href="boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="index.html" title="QUINCE: QUeries IN C++ Expressions">
<link rel="up" href="the_back_end_libraries.html" title="Part&#160;III.&#160;The Back-End Libraries">
<link rel="prev" href="the_back_end_libraries.html" title="Part&#160;III.&#160;The Back-End Libraries">
<link rel="next" href="quince_postgresql/basic.html" title="Basic conversions">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="spirit-nav">
<a accesskey="p" href="the_back_end_libraries.html"><img src="images/prev.png" alt="Prev"></a><a accesskey="u" href="the_back_end_libraries.html"><img src="images/up.png" alt="Up"></a><a accesskey="h" href="index.html"><img src="images/home.png" alt="Home"></a><a accesskey="n" href="quince_postgresql/basic.html"><img src="images/next.png" alt="Next"></a>
</div>
<div class="chapter">
<div class="titlepage"><div><div><h2 class="title">
<a name="quince_postgresql"></a>Chapter&#160;12.&#160;quince_postgresql</h2></div></div></div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl class="toc">
<dt><span class="section"><a href="quince_postgresql.html#quince_postgresql.constructor">The <code class="computeroutput"><span class="identifier">quince_postgresql</span><span class="special">::</span><span class="identifier">database</span></code>
        constructor</a></span></dt>
<dt><span class="section"><a href="quince_postgresql/basic.html">Basic conversions</a></span></dt>
<dt><span class="section"><a href="quince_postgresql/mappers.html">Default mappers</a></span></dt>
</dl>
</div>
<p>
        
      </p>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="quince_postgresql.constructor"></a><a class="link" href="quince_postgresql.html#quince_postgresql.constructor" title="The quince_postgresql::database constructor">The <code class="computeroutput"><span class="identifier">quince_postgresql</span><span class="special">::</span><span class="identifier">database</span></code>
        constructor</a>
</h2></div></div></div>
<p>
          The <code class="computeroutput"><span class="identifier">quince_postgresql</span></code> library's
          <span class="emphasis"><em>application</em></span> program interface (API) is very small,
          because almost all calls into <code class="computeroutput"><span class="identifier">quince_postgresql</span></code>
          are made by quince, not by application code.
        </p>
<p>
          In fact, application code only mentions one of <code class="computeroutput"><span class="identifier">quince_postgresql</span></code>'s
          entry-points: the <code class="computeroutput"><span class="identifier">quince_postgresql</span><span class="special">::</span><span class="identifier">database</span></code>
          constructor. After that, the application asks <span class="emphasis"><em>quince</em></span>
          to create tables, it asks <span class="emphasis"><em>quince</em></span> to build and execute
          queries, manipulate data, etc. All the while, behind the scenes, references
          to the <code class="computeroutput"><span class="identifier">quince_postgresql</span><span class="special">::</span><span class="identifier">database</span></code>
          object are being passed via constructors from tables to queries to value
          mappers, and so on, so quince always knows which backend library to use,
          and it makes frequent use of quince_postgresql functions that are not part
          of its API.
        </p>
<p>
          With that in mind, I present the complete API of quince_postgresql: the
          <code class="computeroutput"><span class="identifier">quince_postgresql</span><span class="special">::</span><span class="identifier">database</span></code> constructor.
        </p>
<p>
          It is available via:
        </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">quince_postgresql</span><span class="special">/</span><span class="identifier">database</span><span class="special">.</span><span class="identifier">h</span><span class="special">&gt;</span>
</pre>
<p>
          and its prototype is:
        </p>
<pre class="programlisting"><span class="identifier">database</span><span class="special">(</span>
    <span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="special">&amp;</span><span class="identifier">host</span><span class="special">,</span>
    <span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="special">&amp;</span><span class="identifier">user</span><span class="special">,</span>
    <span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="special">&amp;</span><span class="identifier">password</span><span class="special">,</span>
    <span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="special">&amp;</span><span class="identifier">db_name</span> <span class="special">=</span> <span class="string">""</span><span class="special">,</span>
    <span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="special">&amp;</span><span class="identifier">default_schema</span> <span class="special">=</span> <span class="string">""</span><span class="special">,</span>
    <span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="special">&amp;</span><span class="identifier">port</span> <span class="special">=</span> <span class="string">""</span><span class="special">,</span>
    <span class="keyword">const</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">isolation_level</span><span class="special">&gt;</span> <span class="identifier">level</span> <span class="special">=</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">none</span><span class="special">,</span>
    <span class="identifier">boost</span><span class="special">::</span><span class="identifier">optional</span><span class="special">&lt;</span><span class="keyword">const</span> <span class="identifier">quince</span><span class="special">::</span><span class="identifier">mapping_customization</span> <span class="special">&amp;&gt;</span> <span class="identifier">customization_for_db</span> <span class="special">=</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">none</span>
<span class="special">);</span>
</pre>
<p>
          Most of the arguments are information that quince_postgresql will use each
          time it creates a connection to the database:
        </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
              <code class="computeroutput"><span class="identifier">host</span></code> is the domain
              name of the host running the PostgreSQL server.
            </li>
<li class="listitem">
              <code class="computeroutput"><span class="identifier">user</span></code> is the PostgreSQL
              user name to use when logging in to the PostgreSQL server.
            </li>
<li class="listitem">
              <code class="computeroutput"><span class="identifier">password</span></code> is the password
              to use if the server demands password authentication.
            </li>
<li class="listitem">
              <code class="computeroutput"><span class="identifier">db_name</span></code> is the name
              of the database to connect to. If empty, it defaults to the user name.
            </li>
<li class="listitem">
              <code class="computeroutput"><span class="identifier">default_schema</span></code>, if
              nonempty, is a PostgreSQL schema name that will be set as the SQL
              <span class="quote">&#8220;<span class="quote">search path</span>&#8221;</span> for each connection. Any quince table object
              with a <a class="link" href="tables/construction.html#binomen">one-part name</a> will be taken as
              referring to a table in that schema.
            </li>
<li class="listitem">
              <code class="computeroutput"><span class="identifier">port</span></code> is the TCP port
              number to connect to, given as a string of decimal digits, e.g. "1234".
              If empty, it defaults to "5432" (the standard default port
              for PostgreSQL).
            </li>
</ul></div>
<p>
          If <code class="computeroutput"><span class="identifier">level</span></code> is supplied, it
          contains a <code class="computeroutput"><span class="identifier">quince_postgresql</span><span class="special">::</span><span class="identifier">isolation_level</span></code>:
        </p>
<pre class="programlisting"><span class="keyword">enum</span> <span class="keyword">class</span> <span class="identifier">isolation_level</span> <span class="special">{</span>
    <span class="identifier">serializable</span><span class="special">,</span> <span class="identifier">repeatable_read</span><span class="special">,</span> <span class="identifier">read_committed</span><span class="special">,</span> <span class="identifier">read_uncommitted</span>
<span class="special">};</span>
</pre>
<p>
          Then all transactions will have the corresponding characteristic (<code class="literal">SERIALIZABLE</code>,
          <code class="literal">REPEATABLE READ</code>, <code class="literal">READ COMMITTED</code> or
          <code class="literal">READ UNCOMMITTED</code>), which are explained <a href="http://www.postgresql.org/docs/9.2/static/sql-set-transaction.html" target="_top">here</a>.
          If you don't supply an <code class="computeroutput"><span class="identifier">isolation_level</span></code>,
          then quince_postgresql doesn't supply one to PostgreSQL, and it uses <code class="literal">READ
          COMMITTED</code> by default.
        </p>
<p>
          <code class="computeroutput"><span class="identifier">customization_for_db</span></code> is
          used to deploy custom mappings throughout the database, as described <a class="link" href="custom/deployment.html#custom.deployment.database" title="To a Database ...">here</a>.
        </p>
<p>
          If you are setting custom mappings for the database, or if you intend to
          add custom mappings for any tables in the database, then you need to read
          the rest of this chapter. Otherwise your study of the quince_postgresql
          library is complete.
        </p>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2014 Michael Shepanski<p>
        Distributed under the Boost Software License, Version 1.0
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="the_back_end_libraries.html"><img src="images/prev.png" alt="Prev"></a><a accesskey="u" href="the_back_end_libraries.html"><img src="images/up.png" alt="Up"></a><a accesskey="h" href="index.html"><img src="images/home.png" alt="Home"></a><a accesskey="n" href="quince_postgresql/basic.html"><img src="images/next.png" alt="Next"></a>
</div>
</body>
</html>
